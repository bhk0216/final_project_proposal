<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Exploratory Data Analysis</title>

<script src="site_libs/header-attrs-2.28/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-6.4.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Home</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="final_report.html">Report</a>
</li>
<li>
  <a href="EDA.html">EDA</a>
</li>
<li>
  <a href="modelling.html">Modelling</a>
</li>
<li class="dropdown-header">Dashboard</li>
<li>
  <a href="https://github.com/bhk0216/p8105_final_project">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Exploratory Data Analysis</h1>

</div>


<div id="data-cleaning-preparing-for-analysis" class="section level2">
<h2>Data Cleaning &amp; Preparing for Analysis</h2>
<pre class="r"><code>library(tidyverse)
library(lsr)
library(vcd)

cleveland = read_csv(&quot;./data/cleveland.csv&quot;, na = &quot;?&quot;)
hungary = read_csv(&quot;./data/hungarian.csv&quot;, na = &quot;?&quot;)
long_beach = read_csv(&quot;./data/long_beach_va.csv&quot;, na = &quot;?&quot;)
switzerland = read_csv(&quot;./data/switzerland.csv&quot;, na = &quot;?&quot;)</code></pre>
<pre class="r"><code>dfs = list(cleveland, hungary, long_beach, switzerland)
regions = c(&quot;Cleveland&quot;, &quot;Hungary&quot;, &quot;Long Beach&quot;, &quot;Switzerland&quot;)

combined_df = map2(dfs, regions, ~ mutate(.x, region = .y)) |&gt;
  bind_rows()</code></pre>
</div>
<div id="summary-of-variables" class="section level2">
<h2>Summary of variables</h2>
<p>The tables below displays descriptive statistics for each variable in
the heart disease dataset, organized by region. The continuous variables
include <code>age</code>, <code>trestbps</code>, <code>thalach</code>,
<code>oldpeak</code> while the discrete variables consist of
<code>sex</code>, <code>cp</code>, <code>fbs</code>,
<code>restecg</code>, <code>exang</code>. These variables will be used
to assess the diagnosis of heart disease, as indicated by the
<code>num</code> variable.</p>
<p>Variables <code>ca</code> and <code>thal</code> were excluded from
the analysis due to incomplete data, with missing values exceeding 85%
in more than two regions, rendering these variables non-comparable.
Additionally, the <code>chol</code> variable was removed from the
analysis as all observations in Switzerland had a value of 0</p>
<div id="cleveland" class="section level3">
<h3>Cleveland</h3>
<pre class="r"><code>summary = function(dataset) {
  dataset_summary = skimr::skim(dataset) |&gt; 
    as.data.frame() |&gt;  
    select(2:6)

  knitr::kable(dataset_summary, digits = 2)
}

summary(cleveland)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">numeric.mean</th>
<th align="right">numeric.sd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">age</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">54.44</td>
<td align="right">9.04</td>
</tr>
<tr class="even">
<td align="left">sex</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">0.68</td>
<td align="right">0.47</td>
</tr>
<tr class="odd">
<td align="left">cp</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">3.16</td>
<td align="right">0.96</td>
</tr>
<tr class="even">
<td align="left">trestbps</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">131.69</td>
<td align="right">17.60</td>
</tr>
<tr class="odd">
<td align="left">chol</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">246.69</td>
<td align="right">51.78</td>
</tr>
<tr class="even">
<td align="left">fbs</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">0.15</td>
<td align="right">0.36</td>
</tr>
<tr class="odd">
<td align="left">restecg</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">0.99</td>
<td align="right">0.99</td>
</tr>
<tr class="even">
<td align="left">thalach</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">149.61</td>
<td align="right">22.88</td>
</tr>
<tr class="odd">
<td align="left">exang</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">0.33</td>
<td align="right">0.47</td>
</tr>
<tr class="even">
<td align="left">oldpeak</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">1.04</td>
<td align="right">1.16</td>
</tr>
<tr class="odd">
<td align="left">slope</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">1.60</td>
<td align="right">0.62</td>
</tr>
<tr class="even">
<td align="left">ca</td>
<td align="right">4</td>
<td align="right">0.99</td>
<td align="right">0.67</td>
<td align="right">0.94</td>
</tr>
<tr class="odd">
<td align="left">thal</td>
<td align="right">2</td>
<td align="right">0.99</td>
<td align="right">4.73</td>
<td align="right">1.94</td>
</tr>
<tr class="even">
<td align="left">num</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">0.94</td>
<td align="right">1.23</td>
</tr>
</tbody>
</table>
</div>
<div id="hungary" class="section level3">
<h3>Hungary</h3>
<pre class="r"><code>summary(hungary)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">numeric.mean</th>
<th align="right">numeric.sd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">age</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">47.83</td>
<td align="right">7.81</td>
</tr>
<tr class="even">
<td align="left">sex</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">0.72</td>
<td align="right">0.45</td>
</tr>
<tr class="odd">
<td align="left">cp</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">2.98</td>
<td align="right">0.97</td>
</tr>
<tr class="even">
<td align="left">trestbps</td>
<td align="right">1</td>
<td align="right">1.00</td>
<td align="right">132.58</td>
<td align="right">17.63</td>
</tr>
<tr class="odd">
<td align="left">chol</td>
<td align="right">23</td>
<td align="right">0.92</td>
<td align="right">250.85</td>
<td align="right">67.66</td>
</tr>
<tr class="even">
<td align="left">fbs</td>
<td align="right">8</td>
<td align="right">0.97</td>
<td align="right">0.07</td>
<td align="right">0.26</td>
</tr>
<tr class="odd">
<td align="left">restecg</td>
<td align="right">1</td>
<td align="right">1.00</td>
<td align="right">0.22</td>
<td align="right">0.46</td>
</tr>
<tr class="even">
<td align="left">thalach</td>
<td align="right">1</td>
<td align="right">1.00</td>
<td align="right">139.13</td>
<td align="right">23.59</td>
</tr>
<tr class="odd">
<td align="left">exang</td>
<td align="right">1</td>
<td align="right">1.00</td>
<td align="right">0.30</td>
<td align="right">0.46</td>
</tr>
<tr class="even">
<td align="left">oldpeak</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">0.59</td>
<td align="right">0.91</td>
</tr>
<tr class="odd">
<td align="left">slope</td>
<td align="right">190</td>
<td align="right">0.35</td>
<td align="right">1.89</td>
<td align="right">0.34</td>
</tr>
<tr class="even">
<td align="left">ca</td>
<td align="right">291</td>
<td align="right">0.01</td>
<td align="right">0.00</td>
<td align="right">0.00</td>
</tr>
<tr class="odd">
<td align="left">thal</td>
<td align="right">266</td>
<td align="right">0.10</td>
<td align="right">5.64</td>
<td align="right">1.62</td>
</tr>
<tr class="even">
<td align="left">num</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">0.36</td>
<td align="right">0.48</td>
</tr>
</tbody>
</table>
</div>
<div id="long-beach" class="section level3">
<h3>Long Beach</h3>
<pre class="r"><code>summary(long_beach)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">numeric.mean</th>
<th align="right">numeric.sd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">age</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">59.35</td>
<td align="right">7.81</td>
</tr>
<tr class="even">
<td align="left">sex</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">0.97</td>
<td align="right">0.17</td>
</tr>
<tr class="odd">
<td align="left">cp</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">3.50</td>
<td align="right">0.80</td>
</tr>
<tr class="even">
<td align="left">trestbps</td>
<td align="right">56</td>
<td align="right">0.72</td>
<td align="right">133.76</td>
<td align="right">21.54</td>
</tr>
<tr class="odd">
<td align="left">chol</td>
<td align="right">7</td>
<td align="right">0.96</td>
<td align="right">178.75</td>
<td align="right">114.04</td>
</tr>
<tr class="even">
<td align="left">fbs</td>
<td align="right">7</td>
<td align="right">0.96</td>
<td align="right">0.35</td>
<td align="right">0.48</td>
</tr>
<tr class="odd">
<td align="left">restecg</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">0.74</td>
<td align="right">0.68</td>
</tr>
<tr class="even">
<td align="left">thalach</td>
<td align="right">53</td>
<td align="right">0.74</td>
<td align="right">122.80</td>
<td align="right">21.99</td>
</tr>
<tr class="odd">
<td align="left">exang</td>
<td align="right">53</td>
<td align="right">0.74</td>
<td align="right">0.65</td>
<td align="right">0.48</td>
</tr>
<tr class="even">
<td align="left">oldpeak</td>
<td align="right">56</td>
<td align="right">0.72</td>
<td align="right">1.32</td>
<td align="right">1.11</td>
</tr>
<tr class="odd">
<td align="left">slope</td>
<td align="right">102</td>
<td align="right">0.49</td>
<td align="right">2.13</td>
<td align="right">0.67</td>
</tr>
<tr class="even">
<td align="left">ca</td>
<td align="right">198</td>
<td align="right">0.01</td>
<td align="right">0.00</td>
<td align="right">0.00</td>
</tr>
<tr class="odd">
<td align="left">thal</td>
<td align="right">166</td>
<td align="right">0.17</td>
<td align="right">6.29</td>
<td align="right">1.29</td>
</tr>
<tr class="even">
<td align="left">num</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">1.52</td>
<td align="right">1.22</td>
</tr>
</tbody>
</table>
</div>
<div id="switzerland" class="section level3">
<h3>Switzerland</h3>
<pre class="r"><code>summary(switzerland)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">numeric.mean</th>
<th align="right">numeric.sd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">age</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">55.32</td>
<td align="right">9.03</td>
</tr>
<tr class="even">
<td align="left">sex</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">0.92</td>
<td align="right">0.27</td>
</tr>
<tr class="odd">
<td align="left">cp</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">3.70</td>
<td align="right">0.69</td>
</tr>
<tr class="even">
<td align="left">trestbps</td>
<td align="right">2</td>
<td align="right">0.98</td>
<td align="right">130.21</td>
<td align="right">22.56</td>
</tr>
<tr class="odd">
<td align="left">chol</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">0.00</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">fbs</td>
<td align="right">75</td>
<td align="right">0.39</td>
<td align="right">0.10</td>
<td align="right">0.31</td>
</tr>
<tr class="odd">
<td align="left">restecg</td>
<td align="right">1</td>
<td align="right">0.99</td>
<td align="right">0.36</td>
<td align="right">0.59</td>
</tr>
<tr class="even">
<td align="left">thalach</td>
<td align="right">1</td>
<td align="right">0.99</td>
<td align="right">121.56</td>
<td align="right">25.98</td>
</tr>
<tr class="odd">
<td align="left">exang</td>
<td align="right">1</td>
<td align="right">0.99</td>
<td align="right">0.44</td>
<td align="right">0.50</td>
</tr>
<tr class="even">
<td align="left">oldpeak</td>
<td align="right">6</td>
<td align="right">0.95</td>
<td align="right">0.65</td>
<td align="right">1.06</td>
</tr>
<tr class="odd">
<td align="left">slope</td>
<td align="right">17</td>
<td align="right">0.86</td>
<td align="right">1.80</td>
<td align="right">0.62</td>
</tr>
<tr class="even">
<td align="left">ca</td>
<td align="right">118</td>
<td align="right">0.04</td>
<td align="right">1.60</td>
<td align="right">0.55</td>
</tr>
<tr class="odd">
<td align="left">thal</td>
<td align="right">52</td>
<td align="right">0.58</td>
<td align="right">5.79</td>
<td align="right">1.73</td>
</tr>
<tr class="even">
<td align="left">num</td>
<td align="right">0</td>
<td align="right">1.00</td>
<td align="right">1.80</td>
<td align="right">1.01</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="distribution-of-participants" class="section level2">
<h2>Distribution of participants</h2>
<p>The plot illustrates the distribution of participants by age and sex
across different regions, with respect to the diagnosis of heart
disease. It is evident that the distribution varies significantly by
region, likely due to differences in participant availability for the
study across these regions.</p>
<p>Overall, there are noticeably more male participants, and the age
distribution is relatively sparse for both groups—those without heart
disease and those with heart disease. However, distinct patterns emerge
when considering the regional breakdown. To gain a deeper understanding
of the factors influencing heart disease prevalence, a more detailed
analysis is necessary to identify which variables are contributing to
the observed trends, and how these factors may differ or remain
consistent across regions.</p>
<pre class="r"><code>ggplot(combined_df, aes(x = age, y = num, color = factor(sex, levels = c(0,1), labels = c(&quot;Female&quot;, &quot;Male&quot;)))) +
  geom_point(alpha = 0.7) +
  facet_wrap(~ region) +
  theme_minimal() +
  labs(title = &quot;Distribution of participants&quot;,
       x = &quot;Age&quot;,
       y = &quot;Heart Disease Status&quot;,
       color = &quot;Sex&quot;)</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>In Hungary, the heart disease status (<code>num</code>) is limited to
values 0 or 1, with no data available for statuses 2, 3, and 4, which
also indicate the presence of heart disease. To ensure consistency
across regions, the <code>num</code> variable was reclassified into a
binary format, with 0 representing no heart disease and 1 representing
heart disease.</p>
<pre class="r"><code>combined_df = combined_df |&gt;
  mutate(num = factor(ifelse(num == 0, 0, 1), levels = c(0, 1)),
  sex = factor(sex, levels = c(0, 1)),
  slope = factor(slope),
  thal = factor(thal),
  cp = factor(cp),
  fbs = factor(fbs),
  restecg = factor(restecg),
  exang = factor(exang))</code></pre>
</div>
<div id="continuous-variables" class="section level2">
<h2>Continuous Variables</h2>
<div id="correlation-heatmap-for-each-region" class="section level3">
<h3>Correlation heatmap for each region</h3>
<p>A correlation heatmap was generated for each region to examine the
relationships between the variables, assess whether these correlations
vary across regions, and to anayze any potential multicolinearity.</p>
<p>At a glance, the correlations differ across regions, with some
showing stronger relationships than others. The following variables were
selected based on the highest correlation values observed in each
region:</p>
<ul>
<li><code>age</code> and <code>thalach</code>: A stronger negative
correlation was found in Hungary (-0.45) and Cleveland (-0.39) compared
to Switzerland (-0.29) and Long Beach (-0.16).</li>
<li><code>age</code> and <code>trestbps</code>: Long Beach exhibited a
stronger positive correlation (0.38) than Cleveland (0.28), Hungary
(0.26), and Switzerland (0.24).</li>
<li><code>thalach</code> and <code>trestbps</code>: A stronger negative
relationship was observed in Switzerland (-0.23) and Hungary (-0.22)
compared to Cleveland (-0.05) and Long Beach (0.00).</li>
<li><code>thalach</code> and <code>oldpeak</code>: A stronger negative
correlation was seen in Cleveland (-0.34) and Hungary (-0.32), while
Long Beach (0.19) and Switzerland (0.17) displayed weak positive
correlations.</li>
</ul>
<p>Despite these notable correlations, none exceed 0.7, suggesting that
each variable has a unique impact on the outcome (heart disease status).
Therefore, multicollinearity is not a concern when modeling a
regression.</p>
<pre class="r"><code>cols_to_include = c(&quot;age&quot;, &quot;trestbps&quot;, &quot;thalach&quot;, &quot;oldpeak&quot;)

corr_plots = list()

par(mar = c(1, 1, 2.2, 1))

for(r in regions) {
  region_data = combined_df |&gt; filter(region == r)
  
  corr_matrix = cor(region_data[, cols_to_include], use = &quot;complete.obs&quot;)
  
  corr_plots[[r]] = corrplot::corrplot(corr_matrix, 
                                       method = &quot;color&quot;, 
                                       type = &quot;lower&quot;,
                                       addCoef.col = &quot;black&quot;, 
                                       tl.col = &quot;black&quot;,
                                       tl.srt = 45)
  mtext(paste(&quot;Correlation Heatmap for&quot;, r), side = 3, line = 1, cex = 1.5)

}</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-9-1.png" width="672" /><img src="EDA_files/figure-html/unnamed-chunk-9-2.png" width="672" /><img src="EDA_files/figure-html/unnamed-chunk-9-3.png" width="672" /><img src="EDA_files/figure-html/unnamed-chunk-9-4.png" width="672" /></p>
<div id="relationship-between-variables-and-heart-disease-status"
class="section level4">
<h4>Relationship Between Variables and Heart Disease Status</h4>
<p>Boxplots were generated for each continuous variable in relation to
heart disease status (<code>num</code>) across different regions. This
analysis aimed to visually explore potential relationships between these
variables and the binary outcome of heart disease status, while also
highlighting regional differences in the distributions of continuous
variables.</p>
<div id="age-age" class="section level5">
<h5>Age (<code>age</code>)</h5>
<p>Age is generally higher in heart disease cases across all regions,
but the degree of overlap varies. Cleveland and Hungary show more
distinct separation, with heart disease cases skewed toward older
individuals. Long Beach and Switzerland exhibit greater overlap,
suggesting weaker age-based differentiation. Outliers in younger
individuals with heart disease are present in Switzerland and Long
Beach.</p>
<p>Age is a strong predictor, especially in Cleveland and Hungary, where
separation is more pronounced. Regions with greater overlap (Long Beach,
Switzerland) suggest the need for interaction terms.</p>
<pre class="r"><code>box_plot = function(data, variable) {
  plot = ggplot(data, aes(x = factor(num), y = .data[[variable]], fill = factor(num))) +
      geom_boxplot() +
      theme(legend.position = &quot;none&quot;) +
      facet_wrap(~region) 
  
  return(plot) 
}

plot_age = box_plot(combined_df, &quot;age&quot;)

plot_age + 
  labs(title = &quot;Boxplot of Age by Heart Disease Status&quot;,
       x = &quot;heart disease status&quot;,
       y = &quot;age&quot;)</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
</div>
<div id="resting-blood-pressure-in-mm-hg-trestbps"
class="section level5">
<h5>Resting Blood Pressure (in mm Hg, <code>trestbps</code>)</h5>
<p>Resting blood pressure shows minimal separation between heart disease
and non-heart disease groups in most regions. Medians and interquartile
ranges are similar across heart disease statuses in Cleveland, Hungary,
and Long Beach. Switzerland shows slightly better separation, though the
overlap remains significant. Outliers are observed in Cleveland and Long
Beach, particularly for non-heart disease cases.</p>
<p>Resting blood pressure may have limited predictive value, as the
overlap between the groups is significant across all regions. However,
it could still contribute as a secondary predictor or in interaction
with other variables.</p>
<pre class="r"><code>plot_trestbps = box_plot(combined_df, &quot;trestbps&quot;)

plot_trestbps + 
  labs(title = &quot;Boxplot of Resting Blood Pressure by Heart Disease Status&quot;,
       x = &quot;heart disease status&quot;,
       y = &quot;resting blood pressure (in mm Hg)&quot;)</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
</div>
<div id="maximum-heart-rate-thalach" class="section level5">
<h5>Maximum Heart Rate (<code>thalach</code>)</h5>
<p>Across all regions, individuals with heart disease generally have
lower maximum heart rates, though the degree of separation varies.
Cleveland and Hungary show larger differences between the two groups.
Long Beach and Switzerland show more overlap, particularly in the upper
ranges of heart rates. Cleveland also has more outliers among non-heart
disease cases.</p>
<p>Maximum heart rate is a strong predictor of heart disease across most
regions, given its consistent trend of lower values in heart disease
cases.</p>
<pre class="r"><code>plot_thalach = box_plot(combined_df, &quot;thalach&quot;)

plot_thalach + 
  labs(title = &quot;Boxplot of Maximum Heart Rate by Heart Disease Status&quot;,
       x = &quot;heart disease status&quot;,
       y = &quot;maximum heart rate&quot;)</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
</div>
<div id="t-depression-oldpeak" class="section level5">
<h5>T Depression (<code>oldpeak</code>)</h5>
<p>T depression appears higher in individuals with heart disease (status
= 1) across all locations compared to those without (status = 0).
Cleveland and Hungary show higher median T depression and larger
interquartile ranges for heart disease cases compared to non-cases. Long
Beach and Switzerland show smaller differences between heart disease and
non-heart disease groups, with generally lower T depression levels.
Outliers in Cleveland and Hungary are more pronounced, suggesting
regional-specific variability.</p>
<p>T depression is likely a good predictor, particularly for Cleveland
and Hungary, as it shows a clear separation between heart disease and
non-heart disease cases. However, its predictive power may vary across
regions, necessitating region-specific adjustments.</p>
<pre class="r"><code>plot_oldpeak = box_plot(combined_df, &quot;oldpeak&quot;)

plot_oldpeak + 
  labs(title = &quot;Boxplot of T Depression by Heart Disease Status&quot;,
       x = &quot;heart disease status&quot;,
       y = &quot;T depression&quot;)</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
</div>
</div>
</div>
<div id="catagorical-variables" class="section level2">
<h2>Catagorical Variables</h2>
<p>the datasets have 7 catagorical Variables:<br />
sex: 1=male; 0=female<br />
cp (chest pain type): 1=typical angina; 2=atypical angina; 3=non-anginal
pain; 4=asymptomatic<br />
fbs (fasting blood sugar &gt; 120 mg/dl): 1=true; 0=false<br />
restecg (resting electrocardiographic results): 0=normal; 1=having ST-T
wave abnormality (T wave inversions and/or ST elevation or depression of
&gt; 0.05 mV); 2: showing probable or definite left ventricular
hypertrophy by Estes’ criteria<br />
exang (exercise induced angina): 1=yes; 0=no<br />
slope (the slope of the peak exercise ST segment): 1=upsloping; 2=flat;
3=downsloping<br />
thal: 3=normal; 6=fixed defect; 7=reversable defect<br />
To examine the variables’ association with num, I will be using Cramér’s
V, which is a method based on the Chi-Squared statistic from a
contingency table of the two variables. It quantifies the strength of
the association, providing a value between 0, indicating no association
between the variables and 1, indicating a perfect association. Using
this menthod, we hope to identify key predictors that have strong
association with num, and thus focus on variables with higher Cramér’s V
values in the modeling efforts. This is also a good way in visualization
into the relationships within the data.</p>
<p>now, let’s look in to the plot, we can see that thal and cp have the
highest Cramér’s V (&gt;=0.5 and &lt;1), suggesting that they are the
most informative categorical predictors of heart disease in the dataset.
Then, exang, slope, and sex also perform moderately good (&gt;= 0.3 and
&lt;0.5), saying that they contribute meaningful information and should
be included in predictive models. lastly, we observe fbs and restecg has
low Cramér’s V (&gt;0 and &lt;0.2), indicating that they contribute
limited information to the model.</p>
<p>While for our EDA, we can check each variables to see if they are
complications of heart disease.</p>
<pre class="r"><code>variables &lt;- c(&quot;sex&quot;, &quot;cp&quot;, &quot;fbs&quot;, &quot;restecg&quot;, &quot;exang&quot;, &quot;slope&quot;, &quot;thal&quot;)

results &lt;- numeric(length(variables))

for (i in seq_along(variables)) {
  var &lt;- variables[i]
  
  df_temp &lt;- combined_df %&gt;%
    select(num, all_of(var)) %&gt;%
    na.omit()
  
  x &lt;- droplevels(as.factor(df_temp$num))
  y &lt;- droplevels(as.factor(df_temp[[var]]))

  table_var &lt;- table(x, y)
  
  results[i] &lt;- cramersV(table_var)
}

association_df &lt;- data.frame(Variable = variables, CramersV = results)

ggplot(association_df, aes(x = reorder(Variable, CramersV), y = CramersV, fill = CramersV)) +
  geom_bar(stat = &quot;identity&quot;) +
  coord_flip() +
  scale_fill_gradient(low = &quot;lightblue&quot;, high = &quot;darkblue&quot;) +
  labs(
    title = &quot;Association Between Heart Disease Status and Predictor Variables&quot;,
    x = &quot;Predictor Variables&quot;,
    y = &quot;Cramér&#39;s V&quot;,
    fill = &quot;Cramér&#39;s V&quot;
  ) +
  theme_minimal()</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<p>This part of graph is a macro-view of the participants, and in
general terms, man would have less chance of getting heart disease than
women.</p>
<pre class="r"><code>ggplot(combined_df, aes(x = sex, fill = num)) +
  geom_bar(position = &quot;fill&quot;) +
  facet_wrap(~ region) +
  labs(
    title = &quot;Proportion of Heart Disease Status by sex&quot;,
    x = &quot;sex&quot;,
    y = &quot;Proportion&quot;,
    fill = &quot;Heart Disease Status&quot;
  ) +
  theme_minimal()</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<p>Chest pain type 4 (asymptomatic) has the strongest association with
getting heart disease across all locations. Chest pain type 1, 2, and 3
tend to show fewer cases of heart disease, specifically, for chest pain
2 (atypical angina), it has lowest proportions of individuals with heart
disease, indicating it might not be a complication of heart
disease.<br />
There is consistency across locations, but proportions vary slightly by
region, suggesting potential regional differences in the dataset or
population characteristics.</p>
<pre class="r"><code>ggplot(combined_df, aes(x = cp, fill = num)) +
  geom_bar(position = &quot;fill&quot;) +
  facet_wrap(~ region) +
  labs(
    title = &quot;Proportion of Heart Disease Status by Chest Pain Type (cp)&quot;,
    x = &quot;Chest Pain Type (cp)&quot;,
    y = &quot;Proportion&quot;,
    fill = &quot;Heart Disease Status&quot;
  ) +
  theme_minimal()</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<p>To interpret the graph, we need to know what is “slope”. In an
exercise electrocardiogram(ECG), an “upward slope” on the ST segment
generally indicates a normal response to exercise as the heart works
harder and electrical activity slightly shifts upward. while a “downward
slope” on the ST segment is typically considered abnormal and suggestive
of myocardial ischemia (reduced blood flow to the heart muscle). As
result, we can convert 1(upsloping) as low risk of getting heart
disease, 2(flat) and 3(downsloping) as moderate risk and high risk of
getting the disease respectively.<br />
The results presented in the graph are almost identical to our
interpretation of the variables after conversion. people are less likely
to get the disease when they have normal peak exercise ST Segment, while
for those who observe abnormal peak exercise ST Segmet, they may have a
higher risk of getting heart disease.</p>
<pre class="r"><code># Plot for &#39;slope&#39; (Slope of Peak Exercise ST Segment)
ggplot(combined_df |&gt; filter(!is.na(slope)), aes(x = slope, fill = num)) +
  geom_bar(position = &quot;fill&quot;) +
  facet_wrap(~ region) +
  labs(
    title = &quot;Proportion of Heart Disease Status by Slope of Peak Exercise ST Segment (slope)&quot;,
    x = &quot;Slope of Peak Exercise ST Segment (slope)&quot;,
    y = &quot;Proportion&quot;,
    fill = &quot;Heart Disease Status&quot;
  ) +
  theme_minimal()</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-17-1.png" width="672" />
For this graph, we can hardly make any conclusion, because whether the
resting electrocardiographic results are normal or not, There was no
significant reduction in the risk of developing the disease.</p>
<pre class="r"><code>ggplot(combined_df |&gt; filter(!is.na(restecg)), aes(x = restecg, fill = num)) +
  geom_bar(position = &quot;fill&quot;) +
  facet_wrap(~ region) +
  labs(
    title = &quot;Proportion of Heart Disease Status by resting electrocardiographic results (restecg)&quot;,
    x = &quot;resting electrocardiographic results (restecg)&quot;,
    y = &quot;Proportion&quot;,
    fill = &quot;Heart Disease Status&quot;
  ) +
  theme_minimal()</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<p>For the graphs list below, we can treat the variables as
binary:<br />
For those who have defect of thalassemia (6 and 7), they tend to have
the disease. If people experienced exercise-induced angina (1), they are
at high risk of getting heart disease. People who have fasting blood
sugar &gt; 120 mg/dl, they have more chance to get the disease compared
to those &lt; 120 mg/dl.</p>
<pre class="r"><code>ggplot(combined_df |&gt; filter(!is.na(thal)), aes(x = thal, fill = num)) +
  geom_bar(position = &quot;fill&quot;) +
  facet_wrap(~ region) +
  labs(
    title = &quot;Proportion of Heart Disease Status by Thalassemia (thal)&quot;,
    x = &quot;Thalassemia (thal)&quot;,
    y = &quot;Proportion&quot;,
    fill = &quot;Heart Disease Status&quot;
  ) +
  theme_minimal()</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<pre class="r"><code># Plot for &#39;exang&#39; (Exercise-Induced Angina)
ggplot(combined_df |&gt; filter(!is.na(exang)), aes(x = exang, fill = num)) +
  geom_bar(position = &quot;fill&quot;) +
  facet_wrap(~ region) +
  labs(
    title = &quot;Proportion of Heart Disease Status by Exercise-Induced Angina (exang)&quot;,
    x = &quot;Exercise-Induced Angina (exang)&quot;,
    y = &quot;Proportion&quot;,
    fill = &quot;Heart Disease Status&quot;
  ) +
  theme_minimal()</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<pre class="r"><code>ggplot(combined_df |&gt; filter(!is.na(fbs)), aes(x = fbs, fill = num)) +
  geom_bar(position = &quot;fill&quot;) +
  facet_wrap(~ region) +
  labs(
    title = &quot;Proportion of Heart Disease Status by fasting blood sugar &gt; 120 mg/dl (fbs)&quot;,
    x = &quot;fasting blood sugar &gt; 120 mg/dl (fbs)&quot;,
    y = &quot;Proportion&quot;,
    fill = &quot;Heart Disease Status&quot;
  ) +
  theme_minimal()</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<p>Though some variables may not suitable for the model, we can still
conclude that the complications of hart disease may be include
asymptomatic chest pain, abnormal Peak Exercise ST Segment, defect of
thalassemia, exercise-induced angina, and fasting blood sugar &gt; 120
mg/dl.<br />
</p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
